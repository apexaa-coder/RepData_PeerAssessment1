---
title: "Reproducible Research: Peer Assessment 1"
author: "Apekshya Ghimire"
date: "`r Sys.Date()`"
output:
  html_document:
    keep_md: true
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading and preprocessing the data
First, we load the required packages and dataset provided.

```{r}
library(readr)
data <- read_csv("activity.csv")

```
Converting Date variable into Date class.

```{r}
data$date<-as.Date(data$date)
```
## What is mean total number of steps taken per day?

Total number of steps per day
For this part, missing values are ignored.

```{r}
steps_per_day<-aggregate(steps~ date, data=data, sum, na.rm=TRUE)
```

Histogram

```{r}
hist(steps_per_day$steps, main = "Histogram of Total Steps Per Day", xlab = "Total Steps",
col = "cyan")

```
Mean and Median of Total Steps per Day

```{r}
mean_steps <- mean(steps_per_day$steps)
median_steps <- median(steps_per_day$steps)
```
avg_steps_interval$interval[which.max(avg_steps_interval$steps)]

Result:
```{r}
  mean_steps
  median_steps
```

## What is the average daily activity pattern?

```{r}
avg_steps_interval <- aggregate(steps ~ interval, data = data, mean, na.rm = TRUE)
avg_steps_interval
```
Time Series Plot

```{r}
plot(avg_steps_interval$interval,
avg_steps_interval$steps,
type = "l",
xlab = "5-minute Interval",
ylab = "Average Number of Steps",
main = "Average Daily Activity Pattern")
```

Interval with Maximum Average Steps

```{r}
max_interval <- avg_steps_interval$interval[
which.max(avg_steps_interval$steps)
]

max_interval
```



## Imputing missing values

Total number of missing values:

```{r}
total_missing <- sum(is.na(data$steps))
total_missing

```

Histogram of imputation

```{r}
interval_means <- avg_steps_interval
data_imputed <- data

for (i in 1:nrow(data_imputed)) {
if (is.na(data_imputed$steps[i])) {
data_imputed$steps[i] <-
interval_means$steps[
interval_means$interval == data_imputed$interval[i]
]
}
}
```

Histogram after imputation

```{r}
steps_per_day_imputed <- aggregate(steps ~ date, data = data_imputed, sum)

hist(steps_per_day_imputed$steps,
main = "Histogram of Total Steps Per Day (Imputed)",
xlab = "Total Steps Per Day",
col = "lightgreen",
breaks = 20)
```

Mean and median after imputation

```{r}
mean_imputed <- mean(steps_per_day_imputed$steps)
median_imputed <- median(steps_per_day_imputed$steps)

mean_imputed
median_imputed

```


## Are there differences in activity patterns between weekdays and weekends?

First creating weekday and weekend variables

```{r}
data_imputed$day_type <- ifelse(
weekdays(data_imputed$date) %in% c("Saturday", "Sunday"),
"Weekend",
"Weekday"
)
```
Compute average steps per interval by day type.

```{r}
avg_steps_daytype <- aggregate(
steps ~ interval + day_type,
data = data_imputed,
mean
)
```

Panel Plot

```{r}
library(lattice)

xyplot(steps ~ interval | day_type,
data = avg_steps_daytype,
type = "l",
layout = c(1, 2),
xlab = "5-minute Interval",
ylab = "Average Number of Steps",
main = "Activity Patterns: Weekdays vs Weekends")

```
Conclusion:
Weekdays show higher activity during morning and early evening intervals, while weekends exhibit more evenly distributed activity throughout the day.